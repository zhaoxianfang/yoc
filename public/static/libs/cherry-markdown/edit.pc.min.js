var customMenuTable=Cherry.createMenuHook('图表',{iconName:'trendingUp',subMenuConfig:[{noIcon:true,name:'折线图',onclick:(event)=>{cherry.insert('\n| :line:{x,y} | Header1 | Header2 | Header3 | Header4 |\n| ------ | ------ | ------ | ------ | ------ |\n| Sample1 | 11 | 11 | 4 | 33 |\n| Sample2 | 112 | 111 | 22 | 222 |\n| Sample3 | 333 | 142 | 311 | 11 |\n')}},{noIcon:true,name:'柱状图',onclick:(event)=>{cherry.insert('\n| :bar:{x,y} | Header1 | Header2 | Header3 | Header4 |\n| ------ | ------ | ------ | ------ | ------ |\n| Sample1 | 11 | 11 | 4 | 33 |\n| Sample2 | 112 | 111 | 22 | 222 |\n| Sample3 | 333 | 142 | 311 | 11 |\n')}},]});const cherryPcConfig={id:'markdown',externals:{echarts:window.echarts,katex:window.katex,MathJax:window.MathJax,},openai:{apiKey:'',ignoreError:false,},engine:{global:{urlProcessor(url,srcType){return url},classicBr:false,htmlWhiteList:'iframe|script|style',flowSessionContext:true,},syntax:{link:{target:'',rel:'',},autoLink:{target:'',rel:'',enableShortLink:true,shortLinkLength:20,},list:{listNested:false,indentSpace:2,},table:{enableChart:true,selfClosing:false,},codeBlock:{theme:'twilight',wrap:true,lineNumber:true,copyCode:true,editCode:true,changeLang:true,expandCode:true,selfClosing:true,customRenderer:{},mermaid:{svg2img:false,},indentedCodeBlock:true,},emoji:{useUnicode:true,},fontEmphasis:{allowWhitespace:false,selfClosing:false,},strikethrough:{needWhitespace:false,},mathBlock:{engine:'MathJax',plugins:false,},inlineMath:{engine:'MathJax',},toc:{allowMultiToc:false,showAutoNumber:false,},image:{videoWrapper:(link,type,defaultWrapper)=>{return defaultWrapper},},header:{anchorStyle:'default',},},},editor:{name:document.getElementById('markdown_content').getAttribute('data-name')||'content',autoSave2Textarea:true,height:' calc( 100vh - 190px ) ',defaultModel:'edit&preview',convertWhenPaste:true,keyMap:'sublime',codemirror:{autofocus:false,placeholder:'开始放飞你的灵感~',},writingStyle:'normal',keepDocumentScrollAfterInit:false,showFullWidthMark:true,showSuggestList:true,},toolbars:{showToolbar:true,toolbar:['undo','redo','bold','italic',{'ruby':['sub','sup','ruby',]},{'ol':['ol','ul','checklist']},'|','size','color','|','header','list','justify',{'insert':['image','audio','video','link','hr','br','code','formula','table','line-table','bar-table','file','drawIo','detail',],},'customMenuTable','togglePreview','search','graph','|','panel',],toolbarRight:['fullScreen','|','wordCount'],sidebar:['mobilePreview','copy','theme','export'],bubble:['bold','italic','underline','strikethrough','sub','sup','quote','|','size','color'],float:['h1','h2','h3','|','checklist','quote','table','code'],hiddenToolbar:[],toc:{updateLocationHash:false,defaultModel:'pure',showAutoNumber:false,position:'absolute',cssText:'',},customMenu:{customMenuTable,},config:{formula:{showLatexLive:false,templateConfig:false,},changeLocale:[{locale:'zh_CN',name:'中文',},{locale:'en_US',name:'English',}],}},drawioIframeUrl:'/static/libs/cherry-markdown/examples/drawio_demo.html',drawioIframeStyle:'border: none;',keydown:[],extensions:[],fileTypeLimitMap:{video:'video/*',audio:'audio/*',image:'image/*',word:'.doc,.docx',pdf:'.pdf',file:'*',},multipleFileSelection:{video:false,audio:false,image:true,word:false,pdf:false,file:false,},callback:{urlProcessor:(url,srcType)=>url,fileUpload:function(file,callback){if(file.size/1024/1024>100){my&&my.msg('上传文件过大...');return false}my&&my.msg('上传中...');var url='';var csrfToken=document.querySelector('meta[name="csrf-token"]').getAttribute('content');var fd=new FormData();if(/video/i.test(file.type)){fd.append('video',file);url='/files/uploads/cherry/video/docs?_token='+csrfToken}else if(/image/i.test(file.type)){fd.append('image',file);url='/files/uploads/cherry/img/docs?_token='+csrfToken}else{var allowFileTypes=['application/vnd.openxmlformats-officedocument.wordprocessingml.document','application/vnd.ms-word','application/vnd.oasis.opendocument.text','application/pdf','application/zip','application/x-zip-compressed','application/x-rar-compressed','application/x-7z-compressed','application/gzip','text/plain'];if(allowFileTypes.includes(file.type)||/audio/i.test(file.type)||/text/i.test(file.type)||/\.md$/.test((file.name).toLowerCase())){fd.append('file',file);url='/files/uploads/cherry/file/docs?_token='+csrfToken}else{my&&my.msg('暂不支持的格式');return false}}$.ajax({method:'POST',url:url,data:fd,contentType:false,processData:false,success:function(res){if(res.code!==200||!res.url){my&&my.msg(res.message||'上传失败');return false}var options={};if(res.filename){options.name=res.filename}if(res.poster){options.poster=res.poster}callback(res.url,options)},error:function(err){my&&my.msg(err.message||'上传失败')},complete:function(res){},})},beforeImageMounted:(srcProp,src)=>({srcProp,src}),onClickPreview:(event)=>{},onCopyCode:(event,code)=>{return code},changeString2Pinyin:(string)=>{return string},afterInit:({text,html})=>{console.log('afterInit 0',text,html);remove_loading()},},event:{afterChange:(text,html)=>{console.log('afterChange')},afterInit:({text,html})=>{console.log('afterInit 1',text,html);remove_loading()},focus:({e,cherry})=>{},blur:({e,cherry})=>{},selectionChange:({selections,lastSelections,info})=>{},afterChangeLocale:(locale)=>{},changeMainTheme:(theme)=>{remove_loading()},changeCodeBlockTheme:(theme)=>{},},previewer:{dom:false,className:'cherry-markdown',enablePreviewerBubble:true,floatWhenClosePreviewer:false,lazyLoadImg:{loadingImgPath:'',maxNumPerTime:2,noLoadImgNum:5,autoLoadImgNum:5,maxTryTimesPerSrc:2,beforeLoadOneImgCallback:(img)=>{return true},failLoadOneImgCallback:(img)=>{},afterLoadOneImgCallback:(img)=>{},afterLoadAllImgCallback:()=>{},},},nameSpace:'cherry',themeSettings:{themeList:[{className:'default',label:'默认'},{className:'dark',label:'暗黑'},{className:'light',label:'明亮'},{className:'green',label:'清新'},{className:'red',label:'热情'},{className:'violet',label:'淡雅'},{className:'blue',label:'清幽'},],mainTheme:localStorage.getItem('docs_theme')||document.documentElement.getAttribute('data-theme')||'light',codeBlockTheme:'default',inlineCodeTheme:'red',toolbarTheme:'dark',},isPreviewOnly:false,autoScrollByCursor:true,forceAppend:true,locale:'zh_CN',locales:{},autoScrollByHashAfterInit:true,};function is_mobile_browser(){const mobileUserAgent=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;if(mobileUserAgent.test(navigator.userAgent)){return true}const mobileViewport=window.matchMedia('(max-width: 767px)');if(mobileViewport.matches){return true}return false}function remove_loading(){setTimeout(()=>{document.querySelector('.editor_loading')?.remove();var cherrr_class=document.querySelector('.cherry');if(is_mobile_browser()){cherrr_class&&cherrr_class.classList.add('cherry_mobile_editor');const elementSidebar=document.querySelector('.cherry-sidebar');if(elementSidebar){elementSidebar.style.display='none'}const elementToc=document.querySelector('.cherry-flex-toc');if(elementToc){elementToc.style.display='none'}document.querySelector('.toolbar-right')?.remove();document.querySelector('.toolbar-left').style.marginRight=0;document.querySelector('.cherry-toolbar').style.padding=0}else{cherrr_class&&cherrr_class.classList.remove('cherry_mobile_editor')}},1000)}if(is_mobile_browser()){cherryPcConfig.toolbars.toolbar.unshift('switchModel');cherryPcConfig.editor.defaultModel='editOnly';cherryPcConfig.toolbars.toolbarRight=[]}const cherryConfig=Object.assign({},cherryPcConfig,{value:document.getElementById("markdown_content").value});window.cherry=new Cherry(cherryConfig);setTimeout(()=>{remove_loading()},6000);

function detect(){let equipmentType="";let agent=navigator.userAgent.toLowerCase();let android=agent.indexOf("android");let iphone=agent.indexOf("iphone");let ipad=agent.indexOf("ipad");if(android!=-1){equipmentType="android"}if(iphone!=-1||ipad!=-1){equipmentType="ios"}return equipmentType}function sendAppData(jsonObj){console.log("H5发送消息给APP",jsonObj,JSON.stringify(jsonObj));if(/android/i.test(navigator.userAgent)){window.app.sendData(JSON.stringify(jsonObj))}else{window.webkit.messageHandlers.sendData.postMessage(JSON.stringify(jsonObj))}}function receiveAppData(data){console.log("H5收到APP的消息",data,JSON.stringify(data));var session_key="uniapp_req_web_login";if(!isEmpty(sessionStorage.getItem(session_key))){return}http_request(`/users/auth/uniapp_login`,data,function(succ){console.log('succ',succ,JSON.stringify(succ));if(succ.code==200){sessionStorage.setItem(session_key,"is_login");sendAppData({type:"web_login",status:true});window.location.reload()}else{sendAppData({type:"web_login",status:false})}},function(err){console.log("receiveAppData error:",JSON.stringify(err));sendAppData({type:"web_login",status:false})},'POST')}

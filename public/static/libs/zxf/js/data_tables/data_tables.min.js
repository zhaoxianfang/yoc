!function(s){"use strict";var TableTools={tableObj:null,tableElement:"#table",customSearchElement:".custom-datatable-search",errMode:"none",dataTableTimes:null,options:{},detailRows:[],onClick:null,onDoubleClick:null,onSearch:null,showMore:null,drawCallback:null,footerCallback:null,headerCallback:null,initComplete:null,infoCallback:null,preDrawCallback:null,createdRow:null,urls:{index_url:"",add_url:"",edit_url:"",del_url:"",detail_url:"",},addTableHeaderBtn:[],tempFunc:{},multi_select_data:[],defaults:{autoWidth:true,deferRender:false,scrollX:true,scrollY:"100%",serverSide:true,info:true,lengthChange:true,lengthMenu:[10,15,20,25,50],paging:true,processing:true,searching:false,show_custom_search:true,show_custom_search_form:false,stateSave:false,showRefreshBtn:true,fixedColumns:{leftColumns:0,rightColumns:0},layout:{topStart:function(){setTimeout(function(){$(".date-table-tools-search-btn").off();$(".date-table-tools-search-btn").on("click",function(){if($(".custom-datatable-search").hasClass("show")){$(".custom-datatable-search").removeClass("show").addClass("hidden")}else{$(".custom-datatable-search").removeClass("hidden").addClass("show")}})},1000);return $(".table-top-buttons").html()},topEnd:{search:{placeholder:"关键字搜索"}},bottomStart:['pageLength','info'],bottomEnd:"paging"},"createdRow":function(row,data,dataIndex){(typeof(this.createdRow)=="function")&&this.createdRow(row,data,dataIndex)},"drawCallback":function(settings){TableTools.events.bindClickEvent();(typeof(TableTools.drawCallback)=="function")&&TableTools.drawCallback(settings)},"footerCallback":function(tfoot,data,start,end,display){(typeof(TableTools.footerCallback)=="function")&&TableTools.footerCallback(tfoot,data,start,end,display)},"headerCallback":function(thead,data,start,end,display){(typeof(TableTools.headerCallback)=="function")&&TableTools.headerCallback(thead,data,start,end,display)},"initComplete":function(settings,json){(typeof(TableTools.initComplete)=="function")&&TableTools.initComplete(settings,json);if("ResizeObserver"in window){TableTools.resizeTable(function(width,height){DataTable.tables({visible:true,api:true}).columns.adjust()})}},"infoCallback":function(settings,start,end,max,total,pre){if(typeof(TableTools.infoCallback)=="function"){TableTools.infoCallback(settings,start,end,max,total,pre)}else{return", 共 "+total+" 条"}},"preDrawCallback":function(settings){(typeof(TableTools.preDrawCallback)=="function")&&TableTools.preDrawCallback(settings)},destroy:false,displayStart:0,order:[],orderClasses:true,orderMulti:true,pageLength:15,pagingType:"first_last_numbers",rowId:"id",scrollCollapse:true,search:{regex:true,caseInsensitive:true,smart:true,search:"",},searchDelay:1200,tabIndex:0,select:true,"ajax":{"url":"","type":"GET","dataSrc":function(json){$(".dt-processing").hide();json.recordsTotal=json.total||json.count||json.recordsTotal||(json.meta?json.meta.total:0);json.recordsFiltered=json.recordsTotal;return json.data||json.list||json.rows||json},"data":function(searchParams,oSettings){return TableTools.getSearchParams(searchParams)},"error":function(jqXHR,textStatus,errorThrown){console.log("jqXHR",jqXHR);TableTools.events.bindClickEvent();$(".dt-processing").hide();const errorMsg=(jqXHR.status===404)?jqXHR.status+"请求的资源不存在":jqXHR.status+"获取数据异常~";$('.dt-empty').text(errorMsg);if(typeof Modal!="undefined"){Modal.error(errorMsg,{position:'center',timeout:3000})}else if(typeof myTools!="undefined"){myTools.msg(errorMsg,3)}else{}}}},getSearchParams(params){let aoData={draw:params.draw,};var searchForm=$(".custom-datatable-search").serializeArray();searchForm.forEach(function(item,index){if(item.name.indexOf("[]")>-1){var name=item.name.replace("[]","");if(!aoData[name]){aoData[name]=[]}aoData[name].push(item.value)}else{aoData[item.name]=item.value}});if(!params.length||params.length<=0){aoData.page=1;aoData.offset=0;aoData.limit=TableTools.options.pageLength}else{aoData.offset=params.start;aoData.limit=params.length;aoData.page=(params.start/params.length)+1}aoData.sort="";aoData.order="desc";aoData.multi_order=[];if(params.order&&params.order.length>0){var columnIdx,orderColumnField;columnIdx=params.order[0]["column"];orderColumnField=params.columns[columnIdx].data;if(orderColumnField&&typeof orderColumnField==="string"){aoData.sort=orderColumnField;aoData.order=params.order[0]["dir"]}if(params.order.length>1){for(var i=0;i<params.order.length;i++){columnIdx=params.order[i]["column"];orderColumnField=params.columns[columnIdx].data;if(orderColumnField&&typeof orderColumnField==="string"){aoData.multi_order.push({field:orderColumnField,order:params.order[i]["dir"]})}}}else{delete aoData.multi_order}}if(params.search&&params.search.value){aoData.search=params.search.value}else{aoData.search=""}return aoData},resizeTable(callback=null){var tableElement=document.querySelector(".dt-container");if(tableElement){var debounceTimer;var resizeObserver=new ResizeObserver(entries=>{for(let entry of entries){if(debounceTimer){clearTimeout(debounceTimer)}debounceTimer=setTimeout(()=>{callback&&callback(entry.contentRect.width,entry.contentRect.height)},800)}});resizeObserver.observe(tableElement)}else{}},language:{"url":"/static/libs/DataTables/DataTables-2.1.2/language/zh.json",select:{rows:'',columns:'',cells:''}},reset:function(){this.tableObj="#table";this.tableElement="#table";this.customSearchElement=".custom-datatable-search";this.errMode="none";this.dataTableTimes=null;this.options={};this.detailRows=[];this.onClick=null;this.onDoubleClick=null;this.onSearch=null;this.showMore=null;this.drawCallback=null;this.footerCallback=null;this.headerCallback=null;this.initComplete=null;this.infoCallback=null;this.preDrawCallback=null;this.createdRow=null;this.urls={index_url:"",add_url:"",edit_url:"",del_url:"",detail_url:"",};this.addTableHeaderBtn=[];this.tempFunc={}},init:function(urls,columns=[],options={},tableElement=this.tableElement,customSearchElement=this.customSearchElement){this.reset();this.tableElement=tableElement;this.customSearchElement=customSearchElement;$.fn.dataTable.ext.errMode=this.errMode||"none";this.tempFunc={};this.urls=$.extend(true,{},this.urls,urls);this.defaults.ajax.url=this.urls.index_url;this.options=$.extend(true,{},this.defaults,options,{"language":this.language,"columns":columns,});return this},drawTable:function(){var _this=this;this.tableObj=$(this.tableElement).DataTable(this.options);$(this.tableElement+" tbody").on("click","tr",function(){var row=_this.tableObj.row(this);var data=row.data();clearTimeout(_this.dataTableTimes);_this.dataTableTimes=setTimeout(function(){var selectedRows=_this.tableObj.rows(".selected").data();var rowsData=[];if(selectedRows.length>0){$(".date-table-multi-select-btn").removeAttr("disabled").removeClass("disabled");selectedRows.each(function(item,index){rowsData.push(item)});TableTools.multi_select_data=rowsData}else{TableTools.multi_select_data=[];$(".date-table-multi-select-btn").attr("disabled","disabled").addClass("disabled")}(typeof(_this.onClick)=="function")&&_this.onClick(data,row)},300)});$(this.tableElement+" tbody").on("dblclick","tr",function(){clearTimeout(_this.dataTableTimes);var row=_this.tableObj.row(this);var data=row.data();(typeof(_this.onDoubleClick)=="function")&&_this.onDoubleClick(data,row)});$(this.tableElement+" tbody").on("click","tr td.dt-control",function(){if(typeof(_this.showMore)!="function"){return}var tr=$(this).closest("tr");var row=_this.tableObj.row(tr);var idx=_this.detailRows.indexOf(tr.attr("id"));if(row.child.isShown()){tr.removeClass("details");row.child.hide();_this.detailRows.splice(idx,1)}else{tr.addClass("details");row.child(_this.showMore(row.data(),row,tr,tr.attr("id"))).show();if(idx===-1){_this.detailRows.push(tr.attr("id"))}}});_this.tableObj.on("order.dt",function(e,settings,columns){});_this.tableObj.on("draw",function(a,b,c){_this.detailRows.forEach(function(id,i){$("#"+id+" td.dt-control").trigger("click")})});$(this.tableElement+" tbody").on("click","td.dt-control",function(e){var table=Table.tableObj;var tr=$(this).closest("tr");var row=table.row(tr);var data=row.data();var rowIndex=e.target._DT_CellIndex.row;var columnIndex=e.target._DT_CellIndex.column;if(row.child.isShown()){row.child.hide()}else{let detailContent="<div class=\"table_row_detail\">no data</div>";if(row.context[0].aoColumns[columnIndex].show_detail&&typeof row.context[0].aoColumns[columnIndex].show_detail==="function"){detailContent="<div class=\"table_row_detail\">"+row.context[0].aoColumns[columnIndex].show_detail(data,rowIndex,row,table)+"</div>"}row.child(detailContent).show()}});$("[data-bs-toggle=\"tab\"],[data-toggle=\"tab\"]").on("shown.bs.tab",function(e){DataTable.tables({visible:true,api:true}).columns.adjust()});CommonSearch.clearSearchForm();this.options.columns.forEach(function(item,index){if(item.search_type){CommonSearch.createSearchFormItem(item)}});CommonSearch.writeSearchForm(TableTools.getTableElement(),TableTools.getCustomSearchElement(),TableTools.getObj(),this.options.show_custom_search_form);$(TableTools.getTableElement()).parents().eq(0).before("<div class=\"table-top-buttons\" style='display: none;'></div>");let btnBoxArea=$(TableTools.getTableElement()).parents().eq(0).siblings(".table-top-buttons");if((this.options.showRefreshBtn===undefined||this.options.showRefreshBtn)&&this.urls.index_url&&this.urls.index_url.length>0){var refreshBtn="<button type=\"button\"  class=\"btn btn-info m-1 btn-xs date-table-tools-refresh-btn\"><i class=\"fa fa-refresh ti ti-refresh\"></i> 刷新</button>";btnBoxArea.append(refreshBtn)}if(this.urls.add_url&&this.urls.add_url.length>0){var addBtn="<button type=\"button\" data-url=\""+this.urls.add_url+"\"  data-title=\"添加\" class=\"btn btn-success m-1 btn-xs date-table-tools-plus-btn\"><i class=\"fa fa-plus ti ti-plus\"></i> 添加</button>";btnBoxArea.append(addBtn)}if(this.options.addTableHeaderBtn&&this.options.addTableHeaderBtn.length>0){var headerBtnHtml=TableTools.createButtonList(this.options.addTableHeaderBtn);btnBoxArea.append(headerBtnHtml)}if(this.options.show_custom_search){var searchBtn="<button type=\"button\"  class=\"btn btn-success m-1 btn-xs date-table-tools-search-btn float-right\"><i class=\"fa fa-search ti ti-search\"></i> 搜索</button>";btnBoxArea.append(searchBtn)}$(".date-table-tools-search-btn").on("click",function(){if($(".custom-datatable-search").hasClass("show")){$(".custom-datatable-search").removeClass("show").addClass("hidden")}else{$(".custom-datatable-search").removeClass("hidden").addClass("show")}});return this.tableObj},addCustomFunc:function(func_name,func,args){this.tempFunc[func_name]={fun:func,args:args}},runCustomFunc:function(func_name="",data=null){var func=this.tempFunc[func_name];func&&func.fun&&func.fun(data??func.args)},getTableElement:function(){return this.tableElement},getCustomSearchElement:function(){return this.customSearchElement},getObj:function(){return this},tools:{status:function(opts={}){var config=$.extend(true,{},{"type":"status",},opts);var colorArr=["info","warning","danger","success","primary","muted","white","secondary","light","dark"];var color="success";var text="none";if(config.data&&(config.data).hasOwnProperty(config.field)&&config.options){if(typeof config.options==="string"){config.options=eval("("+config.options+")")}var value=config.data[config.field];text=config.options[value]?config.options[value].text:value;color=colorArr[value%colorArr.length]||"primary";color=(config.options[value]&&config.options[value].class)?config.options[value].class:color}return"<span class=\"text-"+color+"\"><i class=\"fa fa-circle ti ti-circle-filled\"></i>"+text+"</span>"},label:function(opts={}){var config=$.extend(true,{},{"text":"label","type":"label","class_type":"plain",},opts);return"<span class=\"badge badge-"+config.class_type+"\">"+(config.text?config.text:"none")+"</span>"},icon:function(opts={}){if(!opts.text)return"";opts.text=opts.text.indexOf(" ")>-1?opts.text:("fa fa-"+opts.text+" ti ti-"+opts.text);return"<i class=\""+opts.text+"\"></i> "+opts.text},sub_str:function(opts={}){var config=$.extend(true,{},{"text":"","type":"sub_str","start":0,"length":20,},opts);var value=config.text||"";return"<span data-tips title=\""+value.substring(config.start,config.length)+"\">"+value.substring(config.start,config.length)+"</span>"},datetime:function(opts={}){var config=$.extend(true,{},{"text":"-","type":"datetime","format":"YYYY-MM-DD HH:mm:ss",},opts);if(isNaN(config.text)){return config.text?moment(config.text).format(config.format):"空"}else{return config.text?moment(parseInt(config.text)*1000).format(config.format):"空"}},toggle:function(opts={}){var config=$.extend(true,{},{"open_value":1,"type":"toggle",},opts);var toggle_status="off";if(config.data&&config.data[config.field]){toggle_status=(config.data[config.field]==config.open_value)?"on":"off"}return'<div class="form-check form-check-'+(toggle_status=="on"?'success':'secondary')+' form-switch mb-2"><input type="checkbox" disabled class="form-check-input" '+(toggle_status=="on"?'checked':'')+'></div>';return"<a href='javascript:;' data-toggle='tooltip' class='btn-change' ><i class='fa "+(toggle_status=="on"?"fa-toggle-on ":"fa-toggle-off ")+(toggle_status=="on"?"text-success":"fa-flip-horizontal text-gray")+" fa-2x'></i></a>"},image:function(opts={}){var config=$.extend(true,{},{"type":"image",},opts);var imgUrl="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAEAAAAAAAD/2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcGBwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICAgMDAwYDAwYMCAcIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCAAjACADASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/K5HXfjx4R8N3jW91rlr5yHDLCrz7T6EoGAPtXXV89+MP2WP7PtNV1rUvEllYJvkuNpgLJySVUuWBycgcKTk8A1MpW9ClG/qe2eEviBovjqFpNJ1G3vfL5dUOHQepU4YfUitivlH9l61vLj4wWDWu8RwpI1yR0Ee0jn6sV/HFfV1aSikk0Zxlq0FeJ/tb20erXWkWs2vaZpsMSvIbe4MzNIxOA+2ON+AAQCcd8d69srzj4x/s7W3xY1qDUF1KTTbqOIQyHyfOSRQSRxuXBGTzn8KzkrtGkXa5s/BXwbpPhHwJZ/2WbWf7XEsk93C28XL45O7AOAcgDAx6A5rrqx/APgy3+H3hKz0i1kkmhtFPzyfecsxYn8yeK2K0m7ydjOOi1CiiipKCiiigD//2Q==";if(config.value&&!myTools.func.isEmpty(config.value)){imgUrl=config.value}return"<a href=\""+imgUrl+"\" target=\"_blank\"><img class=\"img-sm img-center\" src=\""+imgUrl+"\" /></a>"},input:function(opts={}){var config=$.extend(true,{},{"text":"","type":"input","event_type":"text",},opts);return"<input type=\""+config.event_type+"\" placeholder='' class=\"form-control\" value=\""+(config.text?config.text:"")+"\">"},url:function(opts={}){var config=$.extend(true,{},{"text":"链接","type":"url",},opts);return"<div class=\"input-group input-group-sm\" style=\"width:250px;margin:0 auto;\"><input type=\"text\" class=\"form-control input-sm\" value=\""+config.text+"\"><span class=\"input-group-btn input-group-sm\"><a href=\""+config.text+"\" target=\"_blank\" class=\"btn btn-default btn-sm\"><i class=\"fa fa-link ti ti-link\"></i></a></span></div>"},ip:function(opts={}){return"<a class=\"btn btn-xs btn-ip bg-success\"><i class=\"fa fa-map-marker ti ti-map-pin\"></i> "+opts.text+"</a>"},btn:function(opts={}){var config=$.extend(true,{},{"text":"操作","title":"标题","class_type":"primary","type":"btn","icon":"","event_type":"layer_open","url_name":"","url_params":"{}","options":"{\"maxmin\":false}",},opts);if(config.event_type=="multi_select"&&typeof config.callback=="function"){var callback_name="callback_"+Math.random().toString(36).substr(2)+(new Date()).getTime();TableTools.getObj().addCustomFunc(callback_name,config.callback,null);return"<button type=\"button\" disabled class=\"btn btn-xs m-1 disabled btn-"+config.class_type+" date-table-multi-select-btn \" data-callback="+callback_name+">"+(config.icon?"<i class=\""+config.icon+"\"></i> ":"")+(config.text?config.text:"BTN")+"</button>"}if(config.event_type=="callback"&&typeof config.callback=="function"){var callback_name="callback_"+Math.random().toString(36).substr(2)+(new Date()).getTime();TableTools.getObj().addCustomFunc(callback_name,config.callback,config.data);return"<button type=\"button\" class=\"btn btn-xs m-1 btn-"+config.class_type+" date-table-callback-btn \" data-callback="+callback_name+">"+(config.icon?"<i class=\""+config.icon+"\"></i> ":"")+(config.text?config.text:"BTN")+"</button>"}var ext_class="";switch(config.event_type){case"layer_open":ext_class="date-table-open-iframe-btn";break;case"jump_url":ext_class="date-table-jump-url-btn";break;case"confirm_open":ext_class="date-table-confirm-btn";break;case"tips":ext_class="date-table-tips-btn";break}if(typeof config.url_params==="string"){config.url_params=eval("("+config.url_params+")")}else{config.url_params={}}if(myTools.func.isEmpty(config.url_name)||myTools.func.isEmpty(TableTools.getObj().urls[config.url_name])){config.url_name=""}var url=!myTools.func.isEmpty(config.url_name)?myTools.func.replaceString(TableTools.getObj().urls[config.url_name],config.url_params):"javascript:;";return"<button type=\"button\" data-url=\""+url+"\" data-title=\""+config.title+"\" data-options='"+(config.options||"{}")+"' class=\"btn btn-xs btn-"+config.class_type+" "+ext_class+"\">"+(config.icon?"<i class=\""+config.icon+"\"></i> ":"")+(config.text?config.text:"BTN")+"</button>"},},createButtonList:function(buttons={}){let btnsHtml="";buttons.forEach(function(item){if(item.type&&TableTools.tools[item.type]){btnsHtml+=TableTools.tools[item.type](item)}else{btnsHtml+=TableTools.tools.label(item)}});return btnsHtml},jsonToUrl:function(obj,parentKey=null){return Object.entries(obj).map(([key,value])=>{const currentKey=parentKey?`${parentKey}[${key}]`:key;if(value!==null&&typeof value==="object"){if(Array.isArray(value)){return value.map((item,index)=>`${currentKey}[${index}]=${encodeURIComponent(item)}`).join("&")}else{return TableTools.jsonToUrl(value,currentKey)}}else{return`${currentKey}=${encodeURIComponent(value)}`}}).join("&")},events:{bindClickEvent:function(){$(".date-table-open-iframe-btn").off("click");$(".date-table-confirm-btn").off("click");$(".date-table-tips-btn").off("click");$(".date-table-jump-url-btn").off("click");$(".date-table-multi-select-btn").off("click");$(".date-table-callback-btn").off("click");$(".date-table-tools-plus-btn").off("click");$(".date-table-tools-refresh-btn").off("click");$(".date-table-multi-select-btn").on("click",function(e){e.preventDefault();var callback=$(this).data("callback");TableTools.getObj().runCustomFunc(callback,TableTools.multi_select_data)});$(".date-table-callback-btn").on("click",function(e){e.preventDefault();var callback=$(this).data("callback");TableTools.getObj().runCustomFunc(callback)});$(".date-table-tools-refresh-btn").on("click",function(e){e.preventDefault();TableTools.getObj().tableObj.draw()});$(".date-table-tools-plus-btn").on("click",function(e){e.preventDefault();var url=$(this).data("url");var title=$(this).data("title");var options=$(this).data("options")||{"maxmin":false};let eventModal=Modal.iframe(title,url,'80%','80%')});$(".date-table-open-iframe-btn").on("click",function(e){e.preventDefault();var url=$(this).data("url");var title=$(this).data("title");var options=$(this).data("options")||"{}";let eventModal=Modal.iframe(title,url,'80%','80%')});$(".date-table-jump-url-btn").on("click",function(e){e.preventDefault();var url=$(this).data("url");window.open(url)});$(".date-table-confirm-btn").on("click",function(e){e.preventDefault();var _this=this;var url=$(this).data("url");var title=$(this).data("title")||"确认进行此操作?";var options=$(this).data("options")||"{}";var top=$(this).offset().top-$(window).scrollTop();var left=$(this).offset().left-$(window).scrollLeft()-260;if(top+154>$(window).height()){top=top-154}if($(window).width()<480){top=left=undefined}layer.confirm(title,{icon:3,title:"温馨提示",skin:"layui-layer-lan",offset:[top,left],shadeClose:true},function(index){myTools.http.post(url,{}).then(function(res){myTools.msg(res.message||"已请求操作");res.wait=res.wait?res.wait:3;if(typeof(res.url)!="undefined"){setTimeout(function(){window.location.href=res.url},res.wait*1000)}}).catch(function(err){});layer.close(index)})});$(".date-table-tips-btn").on("click",function(e){e.preventDefault();var title=$(this).data("title")||"提示信息";var top=$(this).offset().top-$(window).scrollTop();var left=$(this).offset().left-$(window).scrollLeft()-260;if(top+154>$(window).height()){top=top-154}if($(window).width()<480){top=left=undefined}layer.tips(title,this,{offset:[top,left]})})}}};window.TableTools=TableTools;var CommonSearch={commonSearchFormHtml:"",clearSearchForm:function(){this.commonSearchFormHtml=""},writeSearchForm:function(tableElement,customSearchElement,obj,show_custom_search_form=false){if(this.commonSearchFormHtml.length<1){return}this.commonSearchFormHtml+=this.submitBtn();let show_custom_search_form_str=show_custom_search_form?"show":"hidden";var searchFormHtml="<form class='form-inline unbind-form row custom-datatable-search "+show_custom_search_form_str+"' autocomplete=\"off\"><div class='col-lg-12'><div class='ibox'><div class='ibox-content pb-4'><div class='row'>"+this.commonSearchFormHtml+"</div></div></div></div></form>";$(tableElement).parents().eq(0).before(searchFormHtml);this.bind.submit(obj);this.bind.dataTimeEvent()},createSearchFormItem:function(item){var itemHtml="";switch(item.search_type){case"select":itemHtml=this.select(item);break;case"text":itemHtml=this.text(item);break;case"datetimerange":itemHtml=this.datatime(item,"datetimerange");break;case"daterange":itemHtml=this.datatime(item,"daterange");break;case"date":itemHtml=this.datatime(item,"date");break;case"datetime":itemHtml=this.datatime(item,"datetime");break;case"between":itemHtml=this.between(item);break;default:break}this.commonSearchFormHtml+=itemHtml;return itemHtml},bind:{submit:function(obj){$(obj.getCustomSearchElement()).on("submit",function(e){e.preventDefault();(typeof(obj.onSearch)=="function")&&obj.onSearch(e);obj.tableObj.draw()})},dataTimeEvent:function(){$(".datetimerange").daterangepicker({showDropdowns:false,autoUpdateInput:true,opens:"center",timePicker:true,timePicker24Hour:true,timePickerSeconds:true,showWeekNumbers:false,defaultFill:false,locale:{format:"YYYY-MM-DD HH:mm:ss",applyLabel:"确定",cancelLabel:"取消",fromLabel:"从",separator:" ~ ",toLabel:"到",weekLabel:"周",customRangeLabel:"自定义",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],firstDay:1,meridiem:["上午","下午"],today:"今天",}}).on("cancel.daterangepicker",function(ev,picker){$(this).val("")});$(".daterange").daterangepicker({showDropdowns:false,autoUpdateInput:true,opens:"center",showWeekNumbers:false,defaultFill:false,locale:{format:"YYYY-MM-DD",applyLabel:"确定",cancelLabel:"取消",fromLabel:"从",separator:" ~ ",toLabel:"到",weekLabel:"周",customRangeLabel:"自定义",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],firstDay:1,meridiem:["上午","下午"],today:"今天",}}).on("cancel.daterangepicker",function(ev,picker){$(this).val("")});$(".datetime").daterangepicker({singleDatePicker:true,showDropdowns:false,autoUpdateInput:true,minYear:1901,timePicker:true,timePicker24Hour:true,timePickerSeconds:true,defaultFill:false,locale:{format:"YYYY-MM-DD HH:mm:ss",applyLabel:"确定",cancelLabel:"取消",fromLabel:"从",toLabel:"到",weekLabel:"周",customRangeLabel:"自定义",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],firstDay:1,meridiem:["上午","下午"],today:"今天",}}).on("cancel.daterangepicker",function(ev,picker){$(this).val("")});$(".date").daterangepicker({singleDatePicker:true,showDropdowns:false,autoUpdateInput:false,minYear:1901,defaultFill:false,timePicker:false,locale:{format:"YYYY-MM-DD",applyLabel:"确定",cancelLabel:"取消",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],firstDay:1,today:"今天",}}).on("cancel.daterangepicker",function(ev,picker){$(this).val("")})}},text:function(item){let defVal=decodeURIComponent(myTools.func.urlQuery(item.data)||'')||'';return"<div class='form-group col-xs-12 col-sm-6 col-md-4 col-lg-3'><label class='col-md-4 col-form-label p-0'>"+item.title+"</label><div class='col-md-12 p-0'><input type='text' class='form-control w-100' name='"+item.data+"' value='"+defVal+"' placeholder='"+item.title+"'></div></div>"},select:function(item){let defVal=decodeURIComponent(myTools.func.urlQuery(item.data)||'')||'';var html="";if(item.search_options){html="<div class='form-group col-xs-12 col-sm-6 col-md-4 col-lg-3'><label class='col-md-4 col-form-label p-0'>"+item.title+"</label><div class='col-md-12 p-0'><select class='form-control w-100' name='"+item.data+"'><option value=''>请选择</option>";for(var key in item.search_options){html+="<option value='"+key+"' "+(!!defVal&&(key==defVal)?'selected':'')+">"+item.search_options[key]+"</option>"}html+="</select></div></div>"}return html},datatime:function(item,type="datetime"){return"<div class='form-group col-xs-12 col-sm-6 col-md-4 col-lg-3'><label class='col-md-4 col-form-label p-0'>"+item.title+"</label><div class='col-md-12 p-0'><input type='text' class='form-control w-100 "+type+"' name='"+item.data+"' placeholder='"+item.title+"'></div></div>"},between:function(item){return"<div class='form-group col-xs-12 col-sm-6 col-md-4 col-lg-3'><label class='col-md-4 col-form-label p-0'>"+item.title+"</label><div class='col-md-12 p-0'><div class='row row-between'><div class='col-sm-6 pr-1'><input type='text' class='form-control w-100' name='"+item.data+"[]' value='' placeholder='"+item.title+"' id='"+item.data+"-min'></div><div class='col-sm-6 pl-1'><input type='text' class='form-control w-100' name='"+item.data+"[]' value='' placeholder='"+item.title+"' id='"+item.data+"-max'></div></div></div></div>"},submitBtn:function(){return"<div class='form-group col-xs-12 col-sm-6 col-md-4 col-lg-3'><label class='col-md-4 col-form-label p-0'></label><div class='col-md-8 col-12 p-0'><button type='submit' class='btn btn-sm btn-success mr-2'>搜索</button><button type='reset' class='btn btn-sm btn-default'>重置</button></div></div>"}}}(jQuery);
